@import '~@pxblue/colors/palette';


@function createSimplePalette($color) {
    @return ("light": map-get($color, 50), "main": map-get($color, 200), "dark": map-get($color, 500));
}

@function map-deep-get($map, $keys...) {
    @each $key in $keys {
        $map: map-get($map, $key);
    }
    @return $map;
}

/*primary: createSimplePalette(PXBColors.blue),
secondary: createSimplePalette(PXBColors.lightBlue),
error: createSimplePalette(PXBColors.red),
success: createSimplePalette(PXBColors.green),
info: createSimplePalette(PXBColors.lightBlue),
divider: Color(PXBColors.black[200]).alpha(0.32).rgb().string(),
warning: {
    light: PXBColors.yellow[100],
    main: PXBColors.yellow[300],
    dark: PXBColors.yellow[900],
},
background: {
    default: PXBColors.darkBlack[800],
    paper: PXBColors.black[900],
},
text: {
    primary: PXBColors.black[50],
    secondary: PXBColors.black[200],
    disabled: Color(PXBColors.black[300]).alpha(0.32).rgb().string(),
    hint: Color(PXBColors.black[300]).alpha(0.32).rgb().string(),
},
action: {
    hover: Color(PXBColors.black[50]).alpha(0.1).rgb().string(),
    active: PXBColors.black[200],
    disabled: Color(PXBColors.black[50]).alpha(0.1).rgb().string(),
    disabledBackground: Color(PXBColors.black[200]).alpha(0.24).rgb().string(),
},
}; */


@mixin darktheme($theme) {
    $primary: map-get($theme, primary);
    $accent: map-get($theme, accent);
    $foreground: map-get($theme, foreground);
    $background: map-get($theme, background);


    $overrides: (
        "primary": createSimplePalette($primary),
        "secondary": createSimplePalette($accent),
        "error": createSimplePalette($pxb-red),
        "success": createSimplePalette($pxb-green),
        "background": (
            "default": map-get($pxb-darkBlack, 800),
            "paper": map-get($pxb-black, 900)
        ),
        "text": (
            "primary": map-get($pxb-black, 50),
            "secondary": map-get($pxb-black, 200),
        )
    );

    /* Side navigation*/
    .mat-drawer {
        background-color: map-get($background, base);
    }

    /* slide toggle */
    .mat-slide-toggle.mat-primary.mat-checked {
        .mat-slide-toggle-bar {
            background-color: rgba(128, 196, 249, 0.54);
        }
        .mat-slide-toggle-thumb {
            background-color: map-deep-get($overrides, "primary", "main");
        }
    }

    /* badge */
    .mat-badge-content,
    .mat-badge-accent .mat-badge-content {
        color: rgba(0, 0, 0, 0.87);
        background-color: map-deep-get($overrides, "primary", "main");
    }

    /* checkbox */
    .mat-checkbox-checked {
        &.mat-primary, &.mat-accent {
            .mat-checkbox-background {
                background-color: map-deep-get($overrides, "primary", "main");
            }
        }
    }


    /* radio button */
    .mat-radio-button.mat-primary {
        .mat-radio-inner-circle,
        .mat-radio-ripple .mat-ripple-element:not(.mat-radio-persistent-ripple),
        &.mat-radio-checked .mat-radio-persistent-ripple {
            background-color: map-deep-get($overrides, "primary", "main");
        }
        &.mat-radio-checked .mat-radio-outer-circle {
            border-color: map-deep-get($overrides, "primary", "main");
        }

    }

    /* Tooltip  */
    .mat-tooltip {
        background-color: map-get($pxb-black, 500);
    }

        /* toolbar*/
    .mat-toolbar {
        color: map-deep-get($overrides, "text", "primary");
        background-color: map-get($pxb-darkBlack, 100);
        &.mat-primary {
            background-color: map-get($pxb-black, 800);
        }
        &.mat-accent {
            background-color: map-get($pxb-black, 900);
        }
    }


    /*tab bar*/
    .mat-tab-group {
        .mat-tab-label {
            color: map-deep-get($overrides, "text", "secondary");
            background-color: map-deep-get($overrides, "background", "paper");
            &:not(.mat-tab-disabled) {
                opacity: 1;
            }
        }
        .mat-tab-label-active {
            color: map-deep-get($overrides, "primary", "main")
        }
    }
    .mat-tab-group.mat-primary, .mat-tab-nav-bar.mat-primary {
        .mat-ink-bar {
            background-color: map-deep-get($overrides, "primary", "main")
        }
    }

    /* Chips */
    .mat-chip.mat-standard-chip {
        &.mat-primary {
            color: map-get($pxb-white, 50);
            background-color: map-deep-get($overrides, "primary", "dark");
        }
        &:not([color='primary']) {
            background-color: map-get($pxb-black, 500);
            color: map-deep-get($overrides, "text", "primary");
        }
    }

    /* button*/
   /* .mat-stroked-button:not([disabled]) {
        border-color: #c6cacc;
        &.mat-primary {
            border-color: map-get($primary, 500);
        }
        &.mat-accent {
            border-color: map-get($accent, 500);
        }
    } */

    /*Body*/
    .mat-drawer-content {
        background-color: map-get($pxb-darkBlack, 100);
        color: map-get($foreground, text);
    }

    /* selection option*/
    .mat-option.mat-selected:not(.mat-option-disabled) {
        color: map-get($foreground, text);
    }
    .mat-primary .mat-option.mat-selected:not(.mat-option-disabled) {
        color: map-get($foreground, text);
    }
    .mat-accent .mat-option.mat-selected:not(.mat-option-disabled) {
        color: map-get($foreground, text);
    }

    /* snackbar theming */
    .mat-snack-bar-container {
        background-color: map-get($pxb-darkBlack, 500);
    }

    /* input fields */
    .mat-form-field {
        /* Disabled */
        &.mat-form-field-disabled {
            &.mat-form-field-appearance-legacy, &.mat-form-field-appearance-standard {
                .mat-form-field-underline {
                    background-image: none;
                    background-color: rgba(161, 167, 170, 0.36);
                }
            }
            .mat-form-field-label {
                color: rgba(123, 131, 135, 0.32)
            }
            .mat-form-field-outline-thick {
                color: rgba(161, 167, 170, 0.36);
            }
        }
        /* Primary */
        &.mat-primary:not(.mat-form-field-disabled) {
            .mat-form-field-label {
                color: map-get($pxb-black, 200);
            }
            /* Fill */
            &.mat-form-field-appearance-fill {
                .mat-form-field-outline-thick {
                    color: map-deep-get($overrides, "primary", "dark");
                }
                .mat-form-field-flex:hover {
                    background-color: map-get($pxb-black, 600);
                    .mat-form-field-outline-thick {
                        color: map-deep-get($overrides, "error", "main");
                    }
                }
                .mat-form-field-flex:focus-within .mat-form-field-outline-thick {
                    color: map-deep-get($overrides, "error", "dark");
                }
            }
            /* Outline */
            &.mat-form-field-appearance-outline {
                .mat-form-field-outline-thick {
                    .mat-form-field-outline-start, .mat-form-field-outline-end, .mat-form-field-outline-gap {
                        border-width: 1px;
                    }
                    color: map-deep-get($overrides, "primary", "main");
                }
                .mat-form-field-flex:hover .mat-form-field-outline-thick {
                    color: map-get($pxb-black, 50);
                }
                .mat-form-field-flex:focus-within .mat-form-field-outline-thick {
                    color: map-deep-get($overrides, "primary", "dark");
                    .mat-form-field-outline-start, .mat-form-field-outline-end, .mat-form-field-outline-gap {
                        border-width: 2px;
                    }
                }
            }
        }
        /* Error */
        &.mat-form-field-invalid:not(.mat-form-field-disabled) {
            /* Standard */
            &.mat-form-field-appearance-standard {
                .mat-form-field-outline-thick {
                    color: map-deep-get($overrides, "error", "dark");
                }
                .mat-form-field-flex:hover .mat-form-field-outline-thick {
                    color: map-deep-get($overrides, "error", "main");
                }
                .mat-form-field-flex:focus-within .mat-form-field-outline-thick {
                    color: map-deep-get($overrides, "error", "dark");
                }
            }
            /* Fill */
            &.mat-form-field-appearance-fill {
                .mat-form-field-outline-thick {
                    color: map-deep-get($overrides, "error", "dark");
                }
                .mat-form-field-flex:hover {
                    background-color: map-get($pxb-black, 600);
                    .mat-form-field-outline-thick {
                        color: map-deep-get($overrides, "error", "main");
                    }
                }
                .mat-form-field-flex:focus-within .mat-form-field-outline-thick {
                    color: map-deep-get($overrides, "error", "dark");
                }
            }
            /* Outline */
            &.mat-form-field-appearance-outline {
                .mat-form-field-outline-thick {
                    .mat-form-field-outline-start, .mat-form-field-outline-end, .mat-form-field-outline-gap {
                        border-width: 1px;
                    }
                    color: map-deep-get($overrides, "error", "dark");
                }
                .mat-form-field-flex:hover .mat-form-field-outline-thick {
                    color: map-deep-get($overrides, "error", "main");
                }
                .mat-form-field-flex:focus-within .mat-form-field-outline-thick {
                    color: map-deep-get($overrides, "error", "dark");
                    .mat-form-field-outline-start, .mat-form-field-outline-end, .mat-form-field-outline-gap {
                        border-width: 2px;
                    }
                }
            }
        }
    }

    /*stepper*/
    .mat-stepper-horizontal,
    .mat-stepper-vertical {
        background-color: map-get($background, dialog);
        color: map-get($foreground, secondary-text);
    }
    .mat-step-header .mat-step-icon-state-done,
    .mat-step-icon.mat-step-icon-state-number,
    .mat-step-icon.mat-step-icon-state-add {
        background-color: map-get($pxb-gray, 300);
    }
    .mat-step-header[aria-selected='true'] .mat-step-icon {
        background-color: map-get($primary, 500);
    }
    .mat-step-header {
        &:hover,
        &.cdk-program-focused,
        &.cdk-mouse-focused,
        &.cdk-focused {
            background-color: unset;
        }

        .mat-focus-indicator.mat-button-base.ng-star-inserted {
            background-color: unset;
        }
    }

    /* table*/
    .mat-table {
        background-color: map-get($background, app-bar);
    }

    /* paginator*/
    .mat-paginator {
        background-color: map-get($background, app-bar);
        color: map-get($foreground, text);
    }

    /* PXB Drawer */
    .pxb-drawer {
        background-color: map-get($pxb-darkBlack, 300);
        .pxb-drawer-nav-item-active .pxb-info-list-item .mat-list-item-content {
            color: map-get($primary, 200);
        }
        .pxb-drawer-nav-item-active-highlight {
            opacity: 0.2;
        }
        .mat-list-base .mat-list-item,
        .pxb-drawer-nav-item-rail,
        .pxb-drawer-nav-group-title {
            color: map-get($pxb-black, 50);
        }
        .pxb-drawer-nested-nav-item mat-expansion-panel {
            background-color: map-get($pxb-darkBlack, 500);
        }
    }
}
